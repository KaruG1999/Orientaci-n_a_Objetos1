# üìö S√≠ntesis OO1 - Semana 3
## Relaciones entre Objetos, Polimorfismo e Interfaces

---

## üéØ **Conceptos Fundamentales**

### 1. **Relaciones entre Objetos**
> *"Los objetos no viven solos, se relacionan para colaborar"*

**Un objeto conoce a otro cuando:**
- ‚úÖ **Lo mantiene como responsabilidad** (variable de instancia)
- ‚úÖ **Le llega como par√°metro** (relaci√≥n temporal)
- ‚úÖ **Lo crea** durante su ejecuci√≥n
- ‚úÖ **Lo obtiene** enviando mensajes a otros objetos

```java
public class CuentaBancaria {
    private Cliente titular;        // üîó Relaci√≥n duradera: "siempre conozco mi titular"
    private double saldo;
    
    // üîó Relaci√≥n temporal por par√°metro
    public void transferir(double monto, CuentaBancaria destino) {
        this.debitar(monto);
        destino.acreditar(monto);    // "Le delego el trabajo de acreditar"
    }
    
    // üîó Relaci√≥n temporal por creaci√≥n
    public void debitar(double monto) {
        MovimientoBancario mov = new MovimientoBancario("DEBITO", monto);
        this.registrarMovimiento(mov);
    }
}
```

---

### 2. **`this` - El objeto hablando de s√≠ mismo**
> *"Soy yo, hablando de m√≠ mismo"*

**Usos principales:**
- **Descomponer m√©todos largos** en pasos m√°s peque√±os
- **Reutilizar comportamiento** entre m√©todos
- **Pasar mi referencia** para que otros me puedan contactar
- **Desambiguar** variables con el mismo nombre

```java
public class CuentaBancaria {
    private double saldo;
    
    public void transferir(double monto, CuentaBancaria destino) {
        if (this.puedeDebitar(monto)) {        // üîÑ "Me pregunto a m√≠ mismo"
            this.debitar(monto);               // üîÑ "Me ordeno debitar"
            destino.acreditar(monto);
            this.notificarTransferencia();     // üîÑ "Me ordeno notificar"
        }
    }
    
    // Descomposici√≥n en m√©todos m√°s simples
    private boolean puedeDebitar(double monto) {
        return this.saldo >= monto;
    }
}
```

---

### 3. **Identidad vs Igualdad**
> *"¬øSon el mismo objeto o son equivalentes para mi negocio?"*

| Concepto | Operador/M√©todo | Pregunta | Ejemplo |
|----------|----------------|----------|---------|
| **Identidad** | `==` | ¬øEs el mismo objeto en memoria? | `juan1 == juan2` |
| **Igualdad** | `.equals()` | ¬øSon equivalentes seg√∫n mi dominio? | `juan1.equals(juan2)` |

```java
public class Persona {
    private String dni;
    private String nombre;
    
    // ‚öñÔ∏è Igualdad: dos personas son iguales si tienen el mismo DNI
    @Override
    public boolean equals(Object obj) {
        if (obj instanceof Persona) {
            Persona otra = (Persona) obj;
            return this.dni.equals(otra.dni);  // "¬øTenemos el mismo DNI?"
        }
        return false;
    }
}

// üß™ Ejemplo pr√°ctico
Persona juan1 = new Persona("12345678", "Juan P√©rez");
Persona juan2 = new Persona("12345678", "Juan P√©rez");  // Nuevo objeto, mismo DNI

System.out.println(juan1 == juan2);      // ‚ùå FALSE - "¬øSon el mismo objeto?"
System.out.println(juan1.equals(juan2)); // ‚úÖ TRUE  - "¬øSon iguales?" (mismo DNI)
```

---

### 4. **Interfaces - Contratos de Comportamiento**
> *"Una interfaz dice 'QU√â' hacer, la clase dice 'C√ìMO' hacerlo"*

**Beneficios:**
- ‚úÖ **Desacopla** tipo de implementaci√≥n
- ‚úÖ **Permite polimorfismo** entre clases diferentes
- ‚úÖ **Facilita extensibilidad** sin modificar c√≥digo existente

```java
// üìã Interfaz: define QU√â se puede hacer
interface Destino {
    void escribir(String mensaje);  // "Prometo que sabes escribir"
}

// üìÅ Implementaci√≥n 1: escribir en archivo
class ArchivoLog implements Destino {
    private String rutaArchivo;
    
    @Override
    public void escribir(String mensaje) {
        // "YO escribo guardando en un archivo"
        try (FileWriter writer = new FileWriter(rutaArchivo, true)) {
            writer.write(mensaje + "\n");
        }
    }
}

// üñ•Ô∏è Implementaci√≥n 2: escribir en consola
class ConsoleLog implements Destino {
    @Override
    public void escribir(String mensaje) {
        // "YO escribo mostrando en consola"
        System.out.println("[LOG] " + mensaje);
    }
}

// üéØ Cliente: no le importa C√ìMO, solo que sepa escribir
public class MonitorEventos {
    private Destino destino;  // "Solo s√© que puede escribir"
    
    public void registrarEvento(String evento) {
        destino.escribir(evento);  // "No me importa c√≥mo, solo que escriba"
    }
}
```

---

### 5. **Relaciones Uno-a-Muchos con Colecciones**
> *"No conozco a muchos, conozco a UNO que contiene muchos"*

```java
public class Empresa {
    private String nombre;
    private List<Empleado> empleados;      // üì¶ "Conozco UNA lista"
    
    public Empresa(String nombre) {
        this.nombre = nombre;
        this.empleados = new ArrayList<>();  // "Creo mi colecci√≥n vac√≠a"
    }
    
    // ‚ûï Agregar: "Le digo a mi lista que agregue"
    public void contratar(Empleado empleado) {
        empleados.add(empleado);            // "Lista, agreg√° este empleado"
        empleado.setEmpresa(this);          // "Empleado, tu empresa soy yo"
    }
    
    // üîç Consultar: "Le pregunto a mi lista"
    public int cantidadEmpleados() {
        return empleados.size();            // "Lista, ¬øcu√°ntos ten√©s?"
    }
    
    // üîÑ Delegar a cada uno
    public double calcularTotalSueldos() {
        return empleados.stream()
                .mapToDouble(Empleado::getSueldo)    // "Cada empleado, dame tu sueldo"
                .sum();                              // "Sumo todos"
    }
}
```

---

### 6. **Delegaci√≥n vs Envidia**

#### ‚ùå **Envidia (Mal dise√±o)**
> *"Soy envidioso: quiero hacer el trabajo de otros"*

```java
// ‚ùå CLASE ENVIDIOSA - MAL DISE√ëO
public class OfertaEnvidiosa {
    private Producto producto;
    private double porcentajeDescuento;
    
    public double getPrecio() {
        // üö´ ENVIDIA: "Le saco los datos y calculo yo"
        double precioBase = producto.getPrecioBase();
        double descuento = precioBase * (porcentajeDescuento / 100.0);
        return precioBase - descuento;
        
        // Problemas:
        // 1. Si cambia el c√°lculo, hay que modificar AQU√ç
        // 2. Esta clase conoce detalles internos del Producto
        // 3. El Producto es solo un "contenedor de datos"
    }
}
```

#### ‚úÖ **Delegaci√≥n (Buen dise√±o)**
> *"Cada uno hace lo que sabe hacer mejor"*

```java
public class Producto {
    private String nombre;
    private double precioBase;
    
    // ‚úÖ DELEGACI√ìN: "Yo s√© calcular mi precio con descuento"
    public double getPrecioConDescuento(double porcentajeDescuento) {
        double descuento = precioBase * (porcentajeDescuento / 100.0);
        return precioBase - descuento;
    }
}

// ‚úÖ CLASE QUE DELEGA - BUEN DISE√ëO  
public class OfertaDelegadora {
    private Producto producto;
    private double porcentajeDescuento;
    
    public double getPrecio() {
        return producto.getPrecioConDescuento(porcentajeDescuento);
        // ‚úÖ "Cada uno hace lo suyo"
    }
}
```

---

### 7. **Polimorfismo**
> *"Mismo mensaje, diferentes interpretaciones"*

**Caracter√≠sticas:**
- ‚úÖ **Mismo mensaje** se env√≠a a objetos de distintas clases
- ‚úÖ **Diferentes implementaciones** del mismo comportamiento
- ‚úÖ **No necesito saber** la clase espec√≠fica del objeto

```java
// üé® Interfaz com√∫n
interface Figura {
    double area();      // "Prometo que s√© calcular mi √°rea"
    void dibujar();     // "Prometo que me s√© dibujar"
}

class Circulo implements Figura {
    private double radio;
    
    @Override
    public double area() {
        return Math.PI * radio * radio;     // "YO calculo √°rea como œÄ√ór¬≤"
    }
    
    @Override
    public void dibujar() {
        System.out.println("Dibujando un c√≠rculo de radio " + radio);
    }
}

class Rectangulo implements Figura {
    private double ancho, alto;
    
    @Override
    public double area() {
        return ancho * alto;                // "YO calculo √°rea como base√óaltura"
    }
    
    @Override
    public void dibujar() {
        System.out.println("Dibujando un rect√°ngulo " + ancho + "x" + alto);
    }
}

// üé≠ POLIMORFISMO EN ACCI√ìN
public class CalculadoraFiguras {
    // "Me da igual qu√© tipo de figura sea, todas saben calcular su √°rea"
    public double calcularAreaTotal(List<Figura> figuras) {
        double total = 0;
        for (Figura figura : figuras) {
            total += figura.area();     // üé≠ POLIMORFISMO: cada una calcula diferente
        }
        return total;
    }
}
```

---

## üõ†Ô∏è **Ejercicios de la Semana - Aplicaci√≥n Pr√°ctica**

### **Ejercicio 6: Distribuidora El√©ctrica**
**Conceptos aplicados:**
- üîó **Relaciones entre objetos**: Usuario, Consumo, Factura, CuadroTarifario
- üìä **Modelado de dominio** con UML
- üéØ **Identificaci√≥n de responsabilidades**

### **Ejercicio 7: Figuras y Cuerpos**
**Conceptos aplicados:**
- üé≠ **Polimorfismo**: C√≠rculo y Cuadrado con comportamientos similares
- üîÑ **Delegaci√≥n**: Cuerpo3D delega c√°lculos a figuras 2D
- üìã **Interfaces impl√≠citas** para contratos comunes

### **Ejercicio 8: Genealog√≠a Salvaje**
**Conceptos aplicados:**
- üå≥ **Relaciones recursivas**: mam√≠fero conoce a padre y madre
- üîÑ **Delegaci√≥n recursiva**: para encontrar ancestros
- üì¶ **Manejo de colecciones** para relaciones complejas

### **Ejercicio 9: Red de Alumbrado**
**Conceptos aplicados:**
- üîó **Relaciones bidireccionales**: farola conoce a sus vecinas
- üåä **Patr√≥n de propagaci√≥n**: encendido se propaga en cadena
- üéØ **Coordinaci√≥n entre objetos**

---

## ‚≠ê **Conceptos Clave para Recordar**

### üß† **Frases Memorables**

1. **Relaciones**: *"Los objetos colaboran, no viven aislados"*
2. **this**: *"Soy yo hablando de m√≠ mismo"*
3. **Identidad vs Igualdad**: *"== pregunta '¬øes el mismo?', equals() pregunta '¬øson equivalentes?'"*
4. **Interfaces**: *"Interfaz dice QU√â, clase dice C√ìMO"*
5. **Colecciones**: *"No conozco a muchos, conozco a UNO que contiene muchos"*
6. **Delegaci√≥n**: *"Cada uno hace lo que sabe hacer mejor"*
7. **Polimorfismo**: *"Mismo mensaje, diferentes interpretaciones"*

### üí° **Consejos Pr√°cticos**

- ‚úÖ **Usa `this` siempre** en OO1, aunque sea opcional
- ‚úÖ **Implementa `equals()`** pensando en tu dominio de negocio
- ‚úÖ **Prefiere interfaces** a clases concretas para tipear variables
- ‚úÖ **Delega responsabilidades** en lugar de ser envidioso
- ‚úÖ **Busca polimorfismo** cuando veas muchos `instanceof` o `if-else`

### üö® **Se√±ales de Mal Dise√±o**

- ‚ùå **Envidia**: Una clase accede a muchos datos de otra
- ‚ùå **C√≥digo r√≠gido**: Muchos `instanceof` en lugar de polimorfismo  
- ‚ùå **Responsabilidades confusas**: No est√° claro qui√©n debe hacer qu√©
- ‚ùå **Alto acoplamiento**: Cambiar una clase obliga a cambiar muchas otras

---

## üéØ **Mensaje Final**
> *"El dise√±o orientado a objetos exitoso se basa en la colaboraci√≥n: objetos que se conocen, se comunican, delegan responsabilidades y trabajan juntos polim√≥rficamente para resolver problemas complejos de manera elegante y mantenible."*